import sys
import os
import subprocess
import base64
import csv
import shutil
import json
import shlex
import qdarktheme ## NEW FEATURE: For theme switching
from enum import Enum, auto
from PyQt6.QtWidgets import (
    QApplication, QMainWindow, QWidget, QVBoxLayout, QHBoxLayout,
    QPushButton, QFileDialog, QTextEdit, QLabel, QListWidget, QListWidgetItem,
    QStyleFactory, QProgressBar, QSpinBox, QMessageBox, QDialog, QComboBox, QLineEdit,
    QCheckBox
)
from PyQt6.QtCore import QThread, QObject, pyqtSignal, Qt, QByteArray, QBuffer, QIODevice, QRunnable, QThreadPool, QTimer
from PyQt6.QtGui import QMovie, QAction, QIcon, QGuiApplication, QPixmap, QActionGroup

# --- NEW FEATURE: Base64 encoded icon for the window ---
# Replace this with the Base64 string of your own 128x128 PNG or ICO file
APP_ICON_B64 = b'iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAIAAABMXPacAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKAWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDEgNzkuMTRlY2I0MiwgMjAyMi8xMi8wMi0xOToxMjo0NCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDphZDg5YjhlYy0zMjA4LWU5NDAtOGE4My0zZTg5MmU1YmNhNjgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ZmJmNzVmNjktODIzMC00NjRlLTkwN2YtZDJlZTZhZWRlNzhmIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9IjAwMTYwODQ1NUU2RDFBRERDRUY1MTk5RDJBOTY1MUFBIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgdGlmZjpJbWFnZVdpZHRoPSIxMDI0IiB0aWZmOkltYWdlTGVuZ3RoPSIxMDI0IiB0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb249IjIiIHRpZmY6U2FtcGxlc1BlclBpeGVsPSIzIiB0aWZmOlhSZXNvbHV0aW9uPSIxLzEiIHRpZmY6WVJlc29sdXRpb249IjEvMSIgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMSIgZXhpZjpFeGlmVmVyc2lvbj0iMDIzMSIgZXhpZjpDb2xvclNwYWNlPSI2NTUzNSIgZXhpZjpQaXhlbFhEaW1lbnNpb249IjEwMjQiIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSIxMDI0IiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0wNFQyMDo0MjowOCsxMDowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMDRUMjM6MTA6NDErMTA6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjUtMDktMDRUMjM6MTA6NDErMTA6MDAiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplNzRlYTlkOC04MzdhLWM3NDMtOGU4ZC00YjE3MzAwZGZkYmYiIHN0RXZ0OndoZW49IjIwMjUtMDktMDRUMjE6Mjg6NTMrMTA6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyNC4yIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGltYWdlL2pwZWcgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBpbWFnZS9qcGVnIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6N2Q1ODE5ZjItYjJlOC1jNzQzLWFmZjUtMTFmODRmZjRiNDgxIiBzdEV2dDp3aGVuPSIyMDI1LTA5LTA0VDIxOjI4OjUzKzEwOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjQuMiAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmZiZjc1ZjY5LTgyMzAtNDY0ZS05MDdmLWQyZWU2YWVkZTc4ZiIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0wNFQyMzoxMDo0MSsxMDowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDplNzRlYTlkOC04MzdhLWM3NDMtOGU4ZC00YjE3MzAwZGZkYmYiIHN0UmVmOmRvY3VtZW50SUQ9IjAwMTYwODQ1NUU2RDFBRERDRUY1MTk5RDJBOTY1MUFBIiBzdFJlZjpvcmlnaW5hbERvY3VtZW50SUQ9IjAwMTYwODQ1NUU2RDFBRERDRUY1MTk5RDJBOTY1MUFBIi8+IDx0aWZmOkJpdHNQZXJTYW1wbGU+IDxyZGY6U2VxPiA8cmRmOmxpPjg8L3JkZjpsaT4gPHJkZjpsaT44PC9yZGY6bGk+IDxyZGY6bGk+ODwvcmRmOmxpPiA8L3JkZjpTZXE+IDwvdGlmZjpCaXRzUGVyU2FtcGxlPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtreV8UAAGJFSURBVHic1f13uCVVlTeOf9bau+rkG/p23+6mA9ANNNDkICA5Sg4SFEVUBLMzzuDozOiMM2ZHnRkjGDAnggoIChJEguTU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'

# --- Constants & Enums ---
LOADING_GIF_B64 = b'R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1axihOCsitegAAAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZvxvoCTORHolIKYsSoLwAI8A9G5sqDsdwaAyTTu7efvHYKxynWyAAAIfkECQoAAAAsAAAAABAAEAAAAzMIuiJijK6pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZvxvoCTORHolIKYsSoLwAI8A9G5sqDsdwaAyTTu7efvHYKxynWyAAAIfkECQoAAAAsAAAAABAAEAAAAzMIuiJijK6pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECAoAAAAsAAAAABAAEAAAAwYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECAoAAAAsAAAAABAAEAAAAwYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECAoAAAAsAAAAABAAEAAAAwYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAOwAAAAAAAAAAAA=='
MEDIA_EXTENSIONS = {ext.lower() for ext in ['.mkv', '.mp4', '.avi', '.mov', '.wmv', '.flv', '.webm', '.mpg', '.mpeg', '.ts', '.m2ts', '.vob']}

class JobStatus(Enum):
    QUEUED = auto(); RUNNING = auto(); OK = auto(); FAILED = auto(); CANCELLED = auto()

class AppState(Enum):
    IDLE = auto(); RUNNING = auto(); PAUSED = auto(); CANCELLING = auto(); MOVING = auto()

class FileJob:
    def __init__(self, path, list_widget_item):
        self.path = path; self.list_widget_item = list_widget_item
        self.status = JobStatus.QUEUED; self.details = "Queued for processing..."

class WorkerSignals(QObject):
    started = pyqtSignal(int); finished = pyqtSignal(int, bool, str)

class RunnableFFmpegWorker(QRunnable):
    def __init__(self, job_index, job_path, fast_check, fast_duration):
        super().__init__()
        self.job_index = job_index; self.job_path = job_path
        self.fast_check = fast_check; self.fast_duration = fast_duration
        self.signals = WorkerSignals()

    def run(self):
        if not os.path.exists(self.job_path):
            self.signals.finished.emit(self.job_index, False, "Error: File not found at path.")
            return
        self.signals.started.emit(self.job_index)
        try:
            command = ['ffmpeg']
            if self.fast_check: command.extend(['-sseof', f'-{self.fast_duration}'])
            command.extend(['-v', 'error', '-i', self.job_path, '-f', 'null', '-'])
            process = subprocess.run(
                command, capture_output=True, text=True, check=False,
                creationflags=subprocess.CREATE_NO_WINDOW if sys.platform == 'win32' else 0
            )
            is_success = process.returncode == 0 and not process.stderr
            details = process.stderr.strip() or "OK"
            self.signals.finished.emit(self.job_index, is_success, details)
        except Exception as e:
            self.signals.finished.emit(self.job_index, False, f"A critical error occurred: {e}")

class MoveWorkerSignals(QObject):
    file_moved = pyqtSignal(str, str); finished = pyqtSignal(str)

class RunnableMoveWorker(QRunnable):
    def __init__(self, jobs_to_move, dest_folder):
        super().__init__()
        self.jobs_to_move = jobs_to_move; self.dest_folder = dest_folder
        self.signals = MoveWorkerSignals()

    def run(self):
        moved_count, errors = 0, []
        for job in self.jobs_to_move:
            try:
                dest_path = os.path.join(self.dest_folder, os.path.basename(job.path))
                if os.path.exists(dest_path):
                    base, ext = os.path.splitext(dest_path)
                    dest_path = f"{base}_copy{ext}"
                shutil.move(job.path, dest_path)
                self.signals.file_moved.emit(job.path, dest_path); moved_count += 1
            except Exception as e:
                errors.append(f"{os.path.basename(job.path)}: {e}")
        msg = f"Moved {moved_count} file(s).";
        if errors: msg += "\n\nErrors:\n" + "\n".join(errors)
        self.signals.finished.emit(msg)

class RepairCommandDialog(QDialog):
    def __init__(self, input_file, parent=None):
        super().__init__(parent)
        self.input_file = input_file; self.setWindowTitle("Generate Repair Command")
        layout = QVBoxLayout(self)
        layout.addWidget(QLabel(f"Input File: {os.path.basename(input_file)}"))
        out_layout = QHBoxLayout(); out_layout.addWidget(QLabel("Output File:"))
        default_out = f"{os.path.splitext(input_file)[0]}_repaired{os.path.splitext(input_file)[1]}"
        self.output_file_edit = QLineEdit(default_out)
        out_layout.addWidget(self.output_file_edit); layout.addLayout(out_layout)
        codec_layout = QHBoxLayout(); codec_layout.addWidget(QLabel("Method:"))
        self.codec_option = QComboBox()
        self.codec_option.addItems(["Copy (Fastest, Stream Copy)", "Re-encode (H.264, Slow, More Compatible)", "Re-encode (H.265, Slower, Smaller File)"])
        codec_layout.addWidget(self.codec_option); layout.addLayout(codec_layout)
        self.command_preview = QTextEdit(); self.command_preview.setReadOnly(True)
        layout.addWidget(QLabel("Generated Command:")); layout.addWidget(self.command_preview)
        button_layout = QHBoxLayout(); self.copy_button = QPushButton("Copy Command"); self.run_button = QPushButton("Run Repair...")
        self.run_button.setToolTip("Opens a dialog to confirm before running the command directly.")
        button_layout.addWidget(self.copy_button); button_layout.addWidget(self.run_button); layout.addLayout(button_layout)
        self.copy_button.clicked.connect(self.copy_and_close); self.run_button.clicked.connect(self.run_repair)
        self.codec_option.currentTextChanged.connect(self.update_command); self.output_file_edit.textChanged.connect(self.update_command)
        self.update_command()

    def update_command(self): self.command_preview.setText(" ".join(shlex.quote(arg) for arg in self.get_command(quoted=False)))

    def get_command(self, quoted=True):
        out_file = self.output_file_edit.text(); in_file = self.input_file
        codec = self.codec_option.currentText()
        if "Copy" in codec: return ['ffmpeg', '-i', in_file, '-c', 'copy', out_file]
        elif "H.264" in codec: return ['ffmpeg', '-i', in_file, '-c:v', 'libx264', '-preset', 'medium', '-crf', '23', '-c:a', 'aac', out_file]
        else: return ['ffmpeg', '-i', in_file, '-c:v', 'libx265', '-preset', 'medium', '-crf', '28', '-c:a', 'aac', out_file]
        
    def copy_and_close(self): QGuiApplication.clipboard().setText(" ".join(shlex.quote(arg) for arg in self.get_command(quoted=False))); self.accept()
        
    def run_repair(self):
        command_list = self.get_command(quoted=False); command_str = " ".join(shlex.quote(arg) for arg in command_list)
        QGuiApplication.clipboard().setText(command_str)
        reply = QMessageBox.question(self, "Run Repair", f"This will execute the following command:\n\n{command_str}\n\nThis may take a long time and consume system resources. Are you sure?", QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
        if reply == QMessageBox.StandardButton.No: return
        try:
            subprocess.run(command_list, capture_output=True, text=True, check=True, creationflags=subprocess.CREATE_NO_WINDOW if sys.platform == 'win32' else 0)
            QMessageBox.information(self, "Success", f"Repair command completed successfully for:\n{os.path.basename(self.output_file_edit.text())}"); self.accept()
        except subprocess.CalledProcessError as e: QMessageBox.critical(self, "Error", f"Repair command failed with exit code {e.returncode}.\n\nError Output:\n{e.stderr}")
        except Exception as e: QMessageBox.critical(self, "Error", f"An unexpected error occurred: {e}")

class AboutDialog(QDialog):
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setWindowTitle("About Video Integrity Checker"); self.setFixedSize(400, 250)
        layout = QVBoxLayout(self)
        title_label = QLabel("Advanced Video Integrity Checker"); title_label.setStyleSheet("font-size: 16pt; font-weight: bold;"); title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        version_label = QLabel("Version 1.2"); version_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        author_label = QLabel("Developed by Leon Priest"); author_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        link_label = QLabel("<a href='mailto:leonpriest76@gmail.com'>leonpriest76@gmail.com</a>"); link_label.setOpenExternalLinks(True); link_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        description_label = QLabel("This application uses FFmpeg to perform robust, multi-threaded integrity checks on video files."); description_label.setWordWrap(True); description_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        layout.addWidget(title_label); layout.addWidget(version_label); layout.addSpacing(20); layout.addWidget(description_label); layout.addStretch(); layout.addWidget(author_label); layout.addWidget(link_label)

# --- Main Application Window ---
class VideoBatchCheckerApp(QMainWindow):
    def __init__(self):
        super().__init__()
        self.jobs = []; self.state = AppState.IDLE; self.jobs_processed = 0
        self.thread_pool = QThreadPool()
        self.max_threads = max(1, os.cpu_count() or 1); self.thread_pool.setMaxThreadCount(max(1, self.max_threads // 2))
        self.setWindowTitle("Advanced Video Integrity Checker"); self.setGeometry(100, 100, 900, 700); self.setAcceptDrops(True)
        
        ## NEW FEATURE: Set custom window icon
        pixmap = QPixmap()
        pixmap.loadFromData(base64.b64decode(APP_ICON_B64))
        self.setWindowIcon(QIcon(pixmap))
        
        self._create_menus(); self._init_ui(); self._update_ui_for_state(); self._initial_ffmpeg_check()

    def _check_ffmpeg(self):
        try:
            subprocess.run(['ffmpeg', '-version'], capture_output=True, check=True, creationflags=subprocess.CREATE_NO_WINDOW if sys.platform == 'win32' else 0)
            return True
        except (subprocess.CalledProcessError, FileNotFoundError): return False

    def _initial_ffmpeg_check(self):
        if not self._check_ffmpeg():
            QMessageBox.critical(self, "FFmpeg Not Found", "FFmpeg could not be found. The application requires FFmpeg to function.\n\nPlease install it and ensure its location is in your system's PATH, or place it in the same folder as this script.")
            self.check_button.setEnabled(False); self.retry_failed_action.setEnabled(False)

    def _create_menus(self):
        menu_bar = self.menuBar()
        file_menu = menu_bar.addMenu("&File")
        load_action = QAction("&Load Queue...", self); load_action.triggered.connect(self.load_queue)
        save_action = QAction("&Save Queue...", self); save_action.triggered.connect(self.save_queue)
        export_action = QAction("&Export Results...", self); export_action.triggered.connect(self.export_results)
        exit_action = QAction("E&xit", self); exit_action.triggered.connect(self.close)
        file_menu.addActions([load_action, save_action, export_action]); file_menu.addSeparator(); file_menu.addAction(exit_action)
        tools_menu = menu_bar.addMenu("&Tools")
        self.retry_failed_action = QAction("&Retry Failed Files", self); self.retry_failed_action.triggered.connect(self.retry_failed)
        self.clear_verified_action = QAction("Clear &Verified Files", self); self.clear_verified_action.triggered.connect(self.clear_verified)
        self.move_corrupt_action = QAction("&Move Corrupt Files...", self); self.move_corrupt_action.triggered.connect(self.move_corrupt_files)
        tools_menu.addActions([self.retry_failed_action, self.clear_verified_action, self.move_corrupt_action])

        ## NEW FEATURE: Theme and Help menus
        theme_menu = menu_bar.addMenu("&Theme")
        theme_group = QActionGroup(self)
        light_action = QAction("Light Mode", self, checkable=True); light_action.triggered.connect(lambda: self.set_theme('light'))
        dark_action = QAction("Dark Mode", self, checkable=True, checked=True); dark_action.triggered.connect(lambda: self.set_theme('dark'))
        theme_group.addAction(light_action); theme_group.addAction(dark_action)
        theme_menu.addActions([light_action, dark_action])

        help_menu = menu_bar.addMenu("&Help")
        about_action = QAction("&About...", self); about_action.triggered.connect(self.show_about_dialog)
        help_menu.addAction(about_action)
    
    def _init_ui(self):
        central_widget = QWidget(); self.setCentralWidget(central_widget); main_layout = QVBoxLayout(central_widget)
        top_controls_layout = QHBoxLayout(); self.add_files_button = QPushButton("Add Files..."); self.add_folder_button = QPushButton("Add Folder...")
        self.remove_selected_button = QPushButton("Remove Selected"); self.clear_button = QPushButton("Clear All")
        top_controls_layout.addWidget(self.add_files_button); top_controls_layout.addWidget(self.add_folder_button); top_controls_layout.addStretch(); top_controls_layout.addWidget(self.remove_selected_button); top_controls_layout.addWidget(self.clear_button)
        self.file_list_widget = QListWidget(); self.file_list_widget.setSelectionMode(QListWidget.SelectionMode.ExtendedSelection)
        proc_controls_layout = QHBoxLayout(); proc_controls_layout.addWidget(QLabel("Concurrent Checks:"))
        self.thread_spinbox = QSpinBox(); self.thread_spinbox.setMinimum(1); self.thread_spinbox.setMaximum(self.max_threads)
        self.thread_spinbox.setValue(self.thread_pool.maxThreadCount())
        proc_controls_layout.addWidget(self.thread_spinbox); proc_controls_layout.addStretch()
        self.fast_check_box = QCheckBox("Fast Check"); self.fast_check_box.setToolTip("Only checks the end of each file (duration adjustable).\nMay miss corruption in earlier parts of the file.")
        proc_controls_layout.addWidget(self.fast_check_box)
        self.fast_duration_spinbox = QSpinBox(); self.fast_duration_spinbox.setMinimum(10); self.fast_duration_spinbox.setMaximum(600)
        self.fast_duration_spinbox.setValue(60); self.fast_duration_spinbox.setSuffix("s"); self.fast_duration_spinbox.setEnabled(False)
        proc_controls_layout.addWidget(self.fast_duration_spinbox)
        self.check_button = QPushButton("Start Checking"); self.pause_button = QPushButton("Pause"); self.cancel_button = QPushButton("Cancel")
        proc_controls_layout.addWidget(self.check_button); proc_controls_layout.addWidget(self.pause_button); proc_controls_layout.addWidget(self.cancel_button)
        self.progress_bar = QProgressBar()
        details_header_layout = QHBoxLayout(); details_header_layout.addWidget(QLabel("Details:")); details_header_layout.addStretch()
        self.busy_indicator_label = QLabel(); self.copy_details_button = QPushButton("Copy Details"); self.repair_button = QPushButton("Repair...")
        self.repair_button.setToolTip("Open a dialog to generate and run an FFmpeg repair command (only for failed files)")
        details_header_layout.addWidget(self.repair_button); details_header_layout.addWidget(self.copy_details_button); details_header_layout.addWidget(self.busy_indicator_label)
        self.status_label = QLabel("Add files/folders or drag them onto the window to begin.")
        self.details_log = QTextEdit(); self.details_log.setReadOnly(True)
        self.gif_byte_array = QByteArray(base64.b64decode(LOADING_GIF_B64)); self.gif_buffer = QBuffer(self.gif_byte_array); self.gif_buffer.open(QIODevice.OpenModeFlag.ReadOnly)
        self.busy_movie = QMovie(self.gif_buffer, b'gif'); self.busy_indicator_label.setMovie(self.busy_movie); self.busy_indicator_label.setFixedSize(16, 16)
        main_layout.addLayout(top_controls_layout); main_layout.addWidget(QLabel("Files to Process:")); main_layout.addWidget(self.file_list_widget)
        main_layout.addLayout(proc_controls_layout); main_layout.addWidget(self.progress_bar); main_layout.addWidget(self.status_label)
        main_layout.addLayout(details_header_layout); main_layout.addWidget(self.details_log)
        self.add_files_button.clicked.connect(self.add_files); self.add_folder_button.clicked.connect(self.add_folder); self.remove_selected_button.clicked.connect(self.remove_selected)
        self.clear_button.clicked.connect(self.clear_list); self.file_list_widget.currentItemChanged.connect(self.update_details_log)
        self.check_button.clicked.connect(self.start_batch_check); self.pause_button.clicked.connect(self.toggle_pause)
        self.cancel_button.clicked.connect(self.cancel_check); self.thread_spinbox.valueChanged.connect(self.thread_pool.setMaxThreadCount)
        self.copy_details_button.clicked.connect(self.copy_details); self.repair_button.clicked.connect(self.generate_repair_command)
        self.fast_check_box.toggled.connect(self.fast_duration_spinbox.setEnabled)
    
    def _update_ui_for_state(self):
        is_idle = self.state == AppState.IDLE; is_running = self.state == AppState.RUNNING
        is_paused = self.state == AppState.PAUSED; is_cancelling = self.state == AppState.CANCELLING; is_moving = self.state == AppState.MOVING
        is_processing = not is_idle and not is_moving; has_items = len(self.jobs) > 0
        has_completed = any(j.status in [JobStatus.OK, JobStatus.FAILED] for j in self.jobs)
        has_failed = any(j.status == JobStatus.FAILED for j in self.jobs)
        self.centralWidget().setEnabled(not is_moving)
        self.add_files_button.setEnabled(is_idle); self.add_folder_button.setEnabled(is_idle)
        self.clear_button.setEnabled(is_idle and has_items); self.remove_selected_button.setEnabled(is_idle and has_items)
        self.thread_spinbox.setEnabled(is_idle); self.fast_check_box.setEnabled(is_idle); self.fast_duration_spinbox.setEnabled(is_idle and self.fast_check_box.isChecked())
        self.file_list_widget.setEnabled(is_idle or is_paused)
        self.check_button.setVisible(is_idle); self.pause_button.setVisible(is_processing); self.cancel_button.setVisible(is_processing)
        self.check_button.setEnabled(is_idle and has_items)
        self.pause_button.setText("Resume" if is_paused else "Pause")
        self.pause_button.setEnabled(is_running or is_paused); self.cancel_button.setEnabled(not is_cancelling)
        self.progress_bar.setVisible(is_processing); self.busy_indicator_label.setVisible(is_running)
        if is_running: self.busy_movie.start() 
        else: self.busy_movie.stop()
        self.menuBar().setEnabled(not is_moving)
        self.clear_verified_action.setEnabled((is_idle or is_paused) and has_completed)
        self.move_corrupt_action.setEnabled((is_idle or is_paused) and has_failed)
        self.retry_failed_action.setEnabled((is_idle or is_paused) and has_failed)
        self.update_details_log()

    def show_about_dialog(self): dialog = AboutDialog(self); dialog.exec()

    ## NEW FEATURE: Method to set the application theme
    def set_theme(self, theme_name):
        qdarktheme.setup_theme(theme_name)

    def dragEnterEvent(self, event):
        if event.mimeData().hasUrls(): event.acceptProposedAction()
    def dropEvent(self, event):
        paths = [url.toLocalFile() for url in event.mimeData().urls() if os.path.exists(url.toLocalFile())]
        files_to_process = [p for p in paths if os.path.isfile(p) and p.lower().endswith(tuple(MEDIA_EXTENSIONS))]
        for p in paths:
            if os.path.isdir(p):
                files_to_process.extend([os.path.join(r, f) for r, _, fs in os.walk(p) for f in fs if f.lower().endswith(tuple(MEDIA_EXTENSIONS))])
        if files_to_process: self.add_files(sorted(files_to_process))
    def add_files(self, files_to_add=None):
        if not files_to_add: files_to_add, _ = QFileDialog.getOpenFileNames(self, "Select Video Files", "", f"Video Files (*{' *'.join(MEDIA_EXTENSIONS)});;All Files (*)")
        current_paths = {job.path for job in self.jobs}; duplicates = [f for f in files_to_add if f in current_paths]
        new_files = [f for f in files_to_add if f not in current_paths]
        for file in new_files:
            item = QListWidgetItem(f" {os.path.basename(file)}"); item.setToolTip(file)
            self.file_list_widget.addItem(item); self.jobs.append(FileJob(file, item))
        if duplicates:
            duplicate_names = "\n".join(f"- {os.path.basename(f)}" for f in duplicates[:5])
            if len(duplicates) > 5: duplicate_names += "\n...and more."
            QMessageBox.warning(self, "Duplicates Skipped", f"Skipped {len(duplicates)} duplicate file(s) already in the queue:\n{duplicate_names}")
        self._update_ui_for_state()
    def add_folder(self):
        folder = QFileDialog.getExistingDirectory(self, "Select Folder")
        if folder: self.add_files(sorted([os.path.join(r, f) for r, _, fs in os.walk(folder) for f in fs if f.lower().endswith(tuple(MEDIA_EXTENSIONS))]))
    def remove_selected(self):
        if self.state != AppState.IDLE: return
        selected_items = self.file_list_widget.selectedItems();
        if not selected_items: return
        paths_to_remove = {job.path for job in self.jobs if job.list_widget_item in selected_items}
        self.jobs = [job for job in self.jobs if job.path not in paths_to_remove]
        for item in selected_items: self.file_list_widget.takeItem(self.file_list_widget.row(item))
        self._update_ui_for_state()
    def clear_list(self):
        if self.state != AppState.IDLE: return
        self.jobs.clear(); self.file_list_widget.clear(); self.status_label.setText("Add files/folders to begin."); self._update_ui_for_state()
    def start_batch_check(self):
        if not self.jobs: return
        self.state = AppState.RUNNING; self.jobs_processed = 0; jobs_to_run_count = 0
        for job in self.jobs:
            if job.status != JobStatus.OK:
                job.status = JobStatus.QUEUED; job.details = "Queued..."
                job.list_widget_item.setText(f" {os.path.basename(job.path)}"); jobs_to_run_count += 1
        self.progress_bar.setMaximum(jobs_to_run_count if jobs_to_run_count > 0 else 1)
        self.progress_bar.setValue(0); self._update_ui_for_state(); self._submit_jobs()
    def _submit_jobs(self):
        if self.state != AppState.RUNNING: return
        use_fast_check = self.fast_check_box.isChecked(); fast_duration = self.fast_duration_spinbox.value()
        for i, job in enumerate(self.jobs):
            if job.status == JobStatus.QUEUED:
                worker = RunnableFFmpegWorker(i, job.path, use_fast_check, fast_duration)
                worker.signals.started.connect(self.on_file_started); worker.signals.finished.connect(self.on_file_finished)
                self.thread_pool.start(worker)
    def toggle_pause(self):
        if self.state == AppState.RUNNING: self.state = AppState.PAUSED; self.status_label.setText("Paused.")
        elif self.state == AppState.PAUSED: self.state = AppState.RUNNING; self.status_label.setText("Resuming..."); self._submit_jobs()
        self._update_ui_for_state()
    def cancel_check(self):
        if self.state in [AppState.RUNNING, AppState.PAUSED]:
            self.state = AppState.CANCELLING; self.thread_pool.clear()
            self.status_label.setText("Cancelling... Waiting for active checks to finish.")
            self._update_ui_for_state()
            if self.thread_pool.activeThreadCount() == 0: self.on_batch_finished()
    def on_file_started(self, job_index):
        if self.state == AppState.CANCELLING: return
        job = self.jobs[job_index]; job.status = JobStatus.RUNNING
        job.details = "Status: In Progress...\n\nResult: Checking file, please wait."
        job.list_widget_item.setText(f" {os.path.basename(job.path)}"); self.update_details_log(job.list_widget_item)
    def on_file_finished(self, job_index, is_success, details):
        job = self.jobs[job_index]
        if job.status == JobStatus.RUNNING: self.jobs_processed += 1
        job.status = JobStatus.OK if is_success else JobStatus.FAILED
        icon = "" if is_success else ""; job.list_widget_item.setText(f"{os.path.basename(job.path)} {icon}")
        job.details = f"Status: {job.status.name} {icon}\n\n"
        if is_success: job.details += "Result: File integrity verified."
        else: job.details += f"Result: File may be corrupt.\n\nFFmpeg Details:\n------------------\n{details}"
        if self.file_list_widget.currentItem() == job.list_widget_item: self.update_details_log()
        self.progress_bar.setValue(self.jobs_processed)
        self.status_label.setText(f"Processed {self.jobs_processed}/{self.progress_bar.maximum()} files...")
        jobs_to_run_count = self.progress_bar.maximum()
        if self.jobs_processed >= jobs_to_run_count or (self.state == AppState.CANCELLING and self.thread_pool.activeThreadCount() == 0): self.on_batch_finished()
    def on_batch_finished(self):
        if self.state == AppState.CANCELLING:
            self.status_label.setText("Batch processing cancelled.")
            for job in self.jobs:
                if job.status == JobStatus.QUEUED: job.status = JobStatus.CANCELLED
        else:
            self.status_label.setText("Batch processing complete."); self._show_summary_dialog()
        if self.progress_bar.maximum() > 0: self.progress_bar.setValue(self.progress_bar.maximum())
        self.state = AppState.IDLE; self._update_ui_for_state()
    def _show_summary_dialog(self):
        counts = {status: 0 for status in JobStatus};
        for job in self.jobs: counts[job.status] += 1
        msg = f"Processing complete!\n\n Verified: {counts[JobStatus.OK]}\n Failed: {counts[JobStatus.FAILED]}\n Cancelled: {counts[JobStatus.CANCELLED]}"
        failed_files = [j.path for j in self.jobs if j.status == JobStatus.FAILED]
        dialog = QMessageBox(self); dialog.setWindowTitle("Summary"); dialog.setText(msg)
        if failed_files:
            failed_files_str = "\n".join(f"- {os.path.basename(f)}" for f in failed_files)
            dialog.setDetailedText(f"Failed Files:\n{failed_files_str}")
            copy_button = dialog.addButton("Copy Failed List", QMessageBox.ButtonRole.ActionRole)
            copy_button.clicked.connect(lambda: QGuiApplication.clipboard().setText('\n'.join(failed_files)))
        dialog.exec()
    def update_details_log(self, current_item=None):
        if current_item is None: current_item = self.file_list_widget.currentItem()
        if not current_item:
            self.details_log.clear(); self.copy_details_button.setEnabled(False); self.repair_button.setVisible(False); return
        job = next((j for j in self.jobs if j.list_widget_item == current_item), None)
        if job:
            self.details_log.setText(f"Full Path: {job.path}\n\n{job.details}"); self.copy_details_button.setEnabled(True)
            self.repair_button.setVisible(job.status == JobStatus.FAILED)
    def copy_details(self): QGuiApplication.clipboard().setText(self.details_log.toPlainText())
    def generate_repair_command(self):
        job = next((j for j in self.jobs if j.list_widget_item == self.file_list_widget.currentItem()), None)
        if job and job.status == JobStatus.FAILED: dialog = RepairCommandDialog(job.path, self); dialog.exec()
    def save_queue(self):
        path, _ = QFileDialog.getSaveFileName(self, "Save Queue", "", "JSON Queue File (*.json)")
        if path:
            queue_data = [{'path': j.path, 'status': j.status.name, 'details': j.details} for j in self.jobs]
            try:
                with open(path, 'w', encoding='utf-8') as f: json.dump(queue_data, f, indent=2)
            except Exception as e: QMessageBox.critical(self, "Error", f"Could not save queue: {e}")
    def load_queue(self):
        path, _ = QFileDialog.getOpenFileName(self, "Load Queue", "", "JSON Files (*.json);;Text Files (*.txt)")
        if not path: return
        self.clear_list()
        try:
            if path.lower().endswith('.json'):
                with open(path, 'r', encoding='utf-8') as f: queue_data = json.load(f)
                files_to_load = {item['path']:item for item in queue_data if os.path.exists(item['path'])}
                if len(files_to_load) < len(queue_data): QMessageBox.warning(self, "Warning", "Some files from the queue were not found on disk and have been skipped.")
                self.add_files(list(files_to_load.keys()))
                for job in self.jobs:
                    if job.path in files_to_load:
                        item_data = files_to_load[job.path]
                        job.status = JobStatus[item_data.get('status', 'QUEUED')]; job.details = item_data.get('details', 'Queued...')
                        icon = "" if job.status == JobStatus.OK else "" if job.status == JobStatus.FAILED else ""
                        job.list_widget_item.setText(f"{icon} {os.path.basename(job.path)}")
            else:
                with open(path, 'r', encoding='utf-8') as f:
                    files_to_load = [line.strip() for line in f if line.strip() and os.path.exists(line.strip()) and line.strip().lower().endswith(tuple(MEDIA_EXTENSIONS))]
                self.add_files(files_to_load)
        except Exception as e: QMessageBox.critical(self, "Error", f"Could not load queue: {e}")
        self._update_ui_for_state()
    def export_results(self):
        path, _ = QFileDialog.getSaveFileName(self, "Export Results", "", "CSV Files (*.csv)")
        if path:
            try:
                with open(path, 'w', newline='', encoding='utf-8') as f:
                    writer = csv.writer(f); writer.writerow(["File Path", "Status", "Details"])
                    for job in self.jobs: writer.writerow([job.path, job.status.name, job.details.replace('\n', ' | ')])
            except Exception as e: QMessageBox.critical(self, "Error", f"Could not export results: {e}")
    def clear_verified(self):
        for i in range(len(self.jobs) - 1, -1, -1):
            if self.jobs[i].status == JobStatus.OK: self.file_list_widget.takeItem(i); del self.jobs[i]
        self._update_ui_for_state()
    def move_corrupt_files(self):
        dest_folder = QFileDialog.getExistingDirectory(self, "Select Destination for Corrupt Files")
        if not dest_folder: return
        failed_jobs = [j for j in self.jobs if j.status == JobStatus.FAILED]
        if not failed_jobs: QMessageBox.information(self, "No Files to Move", "No corrupt files found."); return
        self.state = AppState.MOVING; self.status_label.setText(f"Moving {len(failed_jobs)} files..."); self._update_ui_for_state()
        worker = RunnableMoveWorker(failed_jobs, dest_folder)
        worker.signals.file_moved.connect(self._update_moved_job_path); worker.signals.finished.connect(self._on_move_finished)
        self.thread_pool.start(worker)
    def _update_moved_job_path(self, old_path, new_path):
        job = next((j for j in self.jobs if j.path == old_path), None)
        if job:
            job.path = new_path; job.details += f"\n\nMOVED to {new_path}"; job.list_widget_item.setToolTip(new_path)
    def _on_move_finished(self, summary_message):
        QMessageBox.information(self, "Move Complete", summary_message); self.state = AppState.IDLE
        self.status_label.setText("Move operation finished."); self._update_ui_for_state()
    def retry_failed(self):
        failed_jobs_to_retry = [j for j in self.jobs if j.status == JobStatus.FAILED]
        if not failed_jobs_to_retry: QMessageBox.information(self, "No Failed Files", "There are no failed files to retry."); return
        self.state = AppState.RUNNING; self.jobs_processed = 0
        self.progress_bar.setMaximum(len(failed_jobs_to_retry)); self.progress_bar.setValue(0)
        for job in failed_jobs_to_retry:
            job.status = JobStatus.QUEUED; job.details = "Queued for retry..."
            job.list_widget_item.setText(f" {os.path.basename(job.path)}")
        self._update_ui_for_state(); self._submit_jobs()
    def closeEvent(self, event):
        if self.state not in [AppState.IDLE, AppState.MOVING]:
            reply = QMessageBox.question(self, 'Exit Confirmation', "A batch process is running. Are you sure you want to exit?", QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No, QMessageBox.StandardButton.No)
            if reply == QMessageBox.StandardButton.No: event.ignore(); return
        self.busy_movie.stop(); self.gif_buffer.close()
        self.thread_pool.clear(); self.thread_pool.waitForDone(-1)
        super().closeEvent(event)

# --- Run the Application ---
if __name__ == "__main__":
    app = QApplication(sys.argv)
    
    ## NEW FEATURE: Set dark theme by default
    qdarktheme.setup_theme("dark")

    window = VideoBatchCheckerApp()
    window.show()
    sys.exit(app.exec())